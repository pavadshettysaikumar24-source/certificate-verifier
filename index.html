<!DOCTYPE html>
<html>
<head>
    <title>Admin â€“ Upload Certificate</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>

<h2 id="title">Checking admin access...</h2>

<div id="adminContent" style="display:none;">
    <h2>Admin Panel â€“ Upload Certificate</h2>

    <input id="name" placeholder="Student Name">
    <input id="course" placeholder="Course">
    <input id="year" placeholder="Year">

    <button onclick="uploadCertificate()">Upload</button>

    <p id="uploadStatus"></p>
</div>

<!-- ethers -->
<script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>

<!-- ðŸ” ADMIN CHECK (SMART CONTRACT BASED) -->
<script>
async function checkAdmin() {
    try {
        if (!window.ethereum) {
            alert("MetaMask required");
            window.location.href = "verify.html";
            return;
        }

        const provider = new ethers.providers.Web3Provider(window.ethereum);
        await provider.send("eth_requestAccounts", []);

        const signer = provider.getSigner();
        const userAddress = await signer.getAddress();

        const contract = new ethers.Contract(
            "0x4426b784E1DDAB879071673d72182c27a9b3e2aa",
            ["function admin() view returns (address)"],
            provider
        );

        const adminAddress = await contract.admin();

        console.log("User:", userAddress);
        console.log("Admin:", adminAddress);

        if (userAddress.toLowerCase() !== adminAddress.toLowerCase()) {
            alert("Only admin wallet can access this page");
            window.location.href = "verify.html";
            return;
        }

        // âœ… Admin verified
        document.getElementById("title").innerText = "Admin Panel â€“ Upload Certificate";
        document.getElementById("adminContent").style.display = "block";

    } catch (err) {
        console.error("Admin check failed:", err);
        window.location.href = "verify.html";
    }
}

window.addEventListener("load", checkAdmin);
</script>

<!-- shared blockchain logic -->
<script src="script.js"></script>

</body>
</html>
